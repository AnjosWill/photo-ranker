<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="data:," />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Photo Ranker ‚Äî MVP</title>
    <link rel="stylesheet" href="./styles/base.css" />
    <link rel="stylesheet" href="./styles/components.css" />
  </head>
  <body>
    <!-- Side Menu -->
    <aside id="sideMenu" class="side-menu" aria-hidden="true">
      <div class="side-menu-header">
        <h3>Projetos</h3>
        <button class="side-menu-close" aria-label="Fechar menu">√ó</button>
      </div>
      <div class="side-menu-list"></div>
    </aside>
    <div id="sideMenuOverlay" class="side-menu-overlay" aria-hidden="true"></div>

    <header class="app-header">
      <div class="app-header-left">
        <button id="sideMenuToggle" class="side-menu-toggle" aria-label="Abrir menu de projetos" aria-expanded="false">
          ‚ò∞
        </button>
      <div class="app-header-brand">
        <img src="./images/logo.png" alt="Photo Ranker" class="app-logo" />
        </div>
      </div>
      <nav id="breadcrumb" class="breadcrumb" aria-label="Navega√ß√£o breadcrumb"></nav>
      <nav class="tabs" role="tablist" aria-label="Navega√ß√£o principal" id="mainTabs">
        <!-- Tabs ser√£o renderizadas dinamicamente via JS -->
      </nav>
    </header>

    <main id="app" class="app-main">
      <!-- PROJECTS (Tela Inicial) -->
      <section
        data-route="projects"
        class="route"
        aria-labelledby="projects-title"
      >
        <h2 id="projects-title" class="sr-only">Projetos</h2>
        <div class="panel">
          <div class="projects-header">
            <h3>Meus Projetos</h3>
            <div style="display: flex; gap: 0.5rem;">
              <button id="importProjectBtn" class="btn btn-secondary">
                Importar
              </button>
              <button id="newProjectBtn" class="btn btn-primary">
                <span>+</span> Novo Projeto
              </button>
            </div>
          </div>
          <div id="projectsGrid" class="projects-grid"></div>
        </div>
      </section>

      <!-- UPLOAD -->
      <section
        data-route="upload"
        class="route active"
        aria-labelledby="upload-title"
      >
        <h2 id="upload-title" class="sr-only">Upload e Organiza√ß√£o</h2>

        <div class="panel">
          <div
            class="dropzone"
            id="dropzone"
            tabindex="0"
            aria-label="√Årea para soltar imagens"
          >
            <p>Arraste e solte imagens aqui</p>
            <p class="muted">ou</p>
            <label class="btn">
              Escolher imagens
              <input
                id="fileInput"
                type="file"
                accept="image/*"
                multiple
                hidden
              />
            </label>
          </div>

          <div class="toolbar">
            <div class="toolbar-left">
              <button
                id="selectModeBtn"
                class="btn btn-secondary"
                aria-pressed="false"
                aria-label="Ativar sele√ß√£o m√∫ltipla"
              >
                Selecionar
              </button>
              <button id="clearAll" class="btn btn-secondary" disabled>
                Limpar
              </button>
            </div>
            <div class="toolbar-right">
              <span id="countInfo" class="muted">0 imagens</span>
            </div>
          </div>

          <!-- Filtros (Sprint 3) -->
          <div class="filters-bar">
            <div class="filter-tabs" role="tablist" aria-label="Filtros de visualiza√ß√£o">
              <button class="filter-tab active" data-filter="all" role="tab" aria-selected="true">
                Todas <span class="count" id="filterCountAll">0</span>
              </button>
              <button class="filter-tab" data-filter="rated5" role="tab" aria-selected="false">
                ‚≠ê 5 estrelas <span class="count" id="filterCountRated5">0</span>
              </button>
              <button class="filter-tab" data-filter="unrated" role="tab" aria-selected="false">
                N√£o avaliadas <span class="count" id="filterCountUnrated">0</span>
              </button>
            </div>
            
            <div class="sort-select-wrapper">
              <label for="sortSelect" class="sort-label">Ordenar:</label>
              <select id="sortSelect" class="sort-select" aria-label="Ordena√ß√£o das fotos">
                <option value="date-desc">üìÖ Data (mais recente)</option>
                <option value="date-asc">üìÖ Data (mais antiga)</option>
                <option value="rating-desc">‚≠ê Avalia√ß√£o (maior)</option>
                <option value="rating-asc">‚≠ê Avalia√ß√£o (menor)</option>
                <option value="size-desc">üì¶ Tamanho (maior)</option>
                <option value="size-asc">üì¶ Tamanho (menor)</option>
                <option value="dimension-desc">üìè Dimens√£o (maior)</option>
                <option value="dimension-asc">üìè Dimens√£o (menor)</option>
              </select>
            </div>
          </div>

          <div id="grid" class="grid grid-photos" aria-live="polite"></div>
        </div>
      </section>

      <!-- RATE -->
      <section data-route="rate" class="route" aria-labelledby="rate-title">
        <h2 id="rate-title" class="sr-only">Avaliar fotos</h2>
        <div id="rateView" class="rate-view"></div>
      </section>

      <!-- CONTEST -->
      <section
        data-route="contest"
        class="route"
        aria-labelledby="contest-title"
      >
        <h2 id="contest-title" class="sr-only">Contest</h2>
        <div id="contestView" class="contest-view">
          <!-- Estado inicial (ser√° renderizado via JS) -->
        </div>
      </section>

      <!-- RESULTS -->
      <section
        data-route="results"
        class="route"
        aria-labelledby="results-title"
      >
        <h2 id="results-title" class="sr-only">Resultados</h2>
        <div id="resultsView" class="results-view">
          <!-- Resultados ser√£o renderizados via JS -->
        </div>
      </section>

      <!-- SETTINGS (Configura√ß√µes do Projeto) -->
      <section
        data-route="settings"
        class="route"
        aria-labelledby="settings-title"
      >
        <h2 id="settings-title" class="sr-only">Configura√ß√µes do Projeto</h2>
        <div id="projectSettingsView" class="project-settings-view">
          <!-- Configura√ß√µes ser√£o renderizadas via JS -->
        </div>
      </section>
    </main>

    <!-- Progress overlay -->
    <div id="progress" class="progress" aria-live="polite" aria-hidden="true">
      <div class="progress-text" id="progressText">Processando‚Ä¶</div>
      <div class="progress-bar"><div id="progressBar"></div></div>
    </div>

    <!-- Viewer fullscreen -->
    <div
      id="viewer"
      class="viewer"
      aria-hidden="true"
      role="dialog"
      aria-modal="true"
    >
      <button class="viewer-close" aria-label="Fechar (Esc)">&times;</button>
      <button class="viewer-prev" aria-label="Anterior">&#10094;</button>
      
      <div class="viewer-image-container" id="viewerImgContainer">
      <img id="viewerImg" alt="Visualiza√ß√£o da foto" />
      </div>
      
      <button class="viewer-next" aria-label="Pr√≥xima">&#10095;</button>
      
      <!-- Rating (Sprint 3) -->
      <div class="viewer-rating" id="viewerRating" aria-label="Avalia√ß√£o da foto"></div>
      
      <!-- Controles de Zoom -->
      <div class="viewer-zoom-controls">
        <button class="viewer-zoom-btn" id="zoomOut" data-tooltip="Zoom out (-)" aria-label="Diminuir zoom">‚àí</button>
        <span class="viewer-zoom-level" id="zoomLevel">100%</span>
        <button class="viewer-zoom-btn" id="zoomIn" data-tooltip="Zoom in (+)" aria-label="Aumentar zoom">+</button>
        <button class="viewer-zoom-btn" id="zoomReset" data-tooltip="Resetar zoom (0)" aria-label="Resetar zoom">‚äó</button>
      </div>
      
      <button class="viewer-split" data-tooltip="Dividir em 2√ó2" aria-label="Dividir em 2√ó2">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="8" height="8" rx="1"/>
          <rect x="13" y="3" width="8" height="8" rx="1"/>
          <rect x="3" y="13" width="8" height="8" rx="1"/>
          <rect x="13" y="13" width="8" height="8" rx="1"/>
        </svg>
      </button>
      <button class="viewer-delete" data-tooltip="Remover" aria-label="Remover esta imagem">
        &#128465;
      </button>
    </div>

    <div id="multiBar" class="multi-bar" aria-hidden="true">
      <span id="multiCount">0 selecionadas</span>
      <button id="multiRemove" class="btn">Remover selecionadas</button>
      <button id="multiClear" class="btn secondary">Cancelar</button>
    </div>

    <div
      id="confirmModal"
      class="modal"
      aria-hidden="true"
      role="dialog"
      aria-modal="true"
      aria-labelledby="confirmTitle"
      aria-describedby="confirmMsg"
    >
      <div class="dialog">
        <h3 id="confirmTitle">Confirmar a√ß√£o</h3>
        <p id="confirmMsg">Tem certeza?</p>
        <div class="actions">
          <button id="confirmCancel" class="btn btn-secondary">
            Cancelar (Esc)
          </button>
          <button id="confirmOk" class="btn btn-danger">Remover</button>
        </div>
      </div>
    </div>

    <!-- Cropper Modal (Sprint 2) -->
    <div
      id="cropperModal"
      class="modal"
      aria-hidden="true"
      role="dialog"
      aria-modal="true"
      aria-labelledby="cropperTitle"
    >
      <div class="cropper-dialog">
        <h3 id="cropperTitle">Ajustar corte 2√ó2</h3>
        <p class="cropper-hint">
          Arraste as guias para ajustar o corte. As 4 fotos ser√£o criadas
          automaticamente.
        </p>
        <div class="cropper-canvas-wrap">
          <canvas id="cropperCanvas"></canvas>
        </div>
        <div class="cropper-preview" aria-label="Preview dos quadrantes"></div>
        <div class="cropper-actions">
          <button id="cropperReset" class="btn btn-secondary">Resetar</button>
          <button id="cropperCancel" class="btn btn-secondary">
            Cancelar (Esc)
          </button>
          <button id="cropperConfirm" class="btn">Confirmar corte</button>
        </div>
      </div>
    </div>

    <!-- Project Edit Modal -->
    <div
      id="projectEditModal"
      class="modal"
      aria-hidden="true"
      role="dialog"
      aria-modal="true"
      aria-labelledby="projectEditTitle"
    >
      <div class="dialog">
        <h3 id="projectEditTitle">Editar Projeto</h3>
        <div class="form-group">
          <label for="projectEditName">Nome *</label>
          <input
            type="text"
            id="projectEditName"
            class="input"
            required
            placeholder="Nome do projeto"
          />
        </div>
        <div class="form-group">
          <label for="projectEditDescription">Descri√ß√£o</label>
          <textarea
            id="projectEditDescription"
            class="input"
            rows="3"
            placeholder="Descri√ß√£o do projeto (opcional)"
          ></textarea>
        </div>
        <div class="actions">
          <button id="projectEditCancel" class="btn btn-secondary">
            Cancelar (Esc)
          </button>
          <button id="projectEditSave" class="btn btn-primary">Salvar</button>
        </div>
      </div>
    </div>

    <!-- Project Create Modal -->
    <div
      id="projectCreateModal"
      class="modal"
      aria-hidden="true"
      role="dialog"
      aria-modal="true"
      aria-labelledby="projectCreateTitle"
    >
      <div class="dialog">
        <h3 id="projectCreateTitle">Novo Projeto</h3>
        <div class="form-group">
          <label for="projectCreateName">Nome *</label>
          <input
            type="text"
            id="projectCreateName"
            class="input"
            required
            placeholder="Nome do projeto"
          />
        </div>
        <div class="form-group">
          <label for="projectCreateDescription">Descri√ß√£o</label>
          <textarea
            id="projectCreateDescription"
            class="input"
            rows="3"
            placeholder="Descri√ß√£o do projeto (opcional)"
          ></textarea>
        </div>
        <div class="actions">
          <button id="projectCreateCancel" class="btn btn-secondary">
            Cancelar (Esc)
          </button>
          <button id="projectCreateSave" class="btn btn-primary">Criar</button>
        </div>
      </div>
    </div>

    <!-- Folder Edit Modal -->
    <div
      id="folderEditModal"
      class="modal"
      aria-hidden="true"
      role="dialog"
      aria-modal="true"
      aria-labelledby="folderEditTitle"
    >
      <div class="dialog">
        <h3 id="folderEditTitle">Editar Nome da Pasta</h3>
        <div class="form-group">
          <label for="folderEditName">Nome *</label>
          <input
            type="text"
            id="folderEditName"
            class="input"
            required
            placeholder="Nome da pasta"
          />
        </div>
        <div class="actions">
          <button id="folderEditCancel" class="btn btn-secondary">
            Cancelar (Esc)
          </button>
          <button id="folderEditSave" class="btn btn-primary">Salvar</button>
        </div>
      </div>
    </div>

    <!-- Folder Create Modal -->
    <div
      id="folderCreateModal"
      class="modal"
      aria-hidden="true"
      role="dialog"
      aria-modal="true"
      aria-labelledby="folderCreateTitle"
    >
      <div class="dialog">
        <h3 id="folderCreateTitle">Nova Pasta</h3>
        <div class="form-group">
          <label for="folderCreateName">Nome *</label>
          <input
            type="text"
            id="folderCreateName"
            class="input"
            required
            placeholder="Nome da pasta"
          />
        </div>
        <div class="actions">
          <button id="folderCreateCancel" class="btn btn-secondary">
            Cancelar (Esc)
          </button>
          <button id="folderCreateSave" class="btn btn-primary">Criar</button>
        </div>
      </div>
    </div>

    <footer class="app-footer">
      <small>Mobile-first ‚Ä¢ Offline-ready (em breve PWA) ‚Ä¢ A11Y</small>
    </footer>

    <!-- JSZip para export/import -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <!-- Input file oculto para importa√ß√£o -->
    <input type="file" id="importProjectFile" accept=".zip" style="display: none;" />

    <script type="module" src="./scripts/app.js"></script>
  </body>
</html>
